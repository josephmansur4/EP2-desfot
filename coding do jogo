import random

CONFIGURACAO = {
    'destroyer': 3,
    'porta-avioes': 5,
    'submarino': 2,
    'torpedeiro': 3,
    'cruzador': 2,
    'couracado': 4
}

PAISES = {
    'Brasil': {
        'cruzador': 1,
        'torpedeiro': 2,
        'destroyer': 1,
        'couracado': 1,
        'porta-avioes': 1
    },
    'França': {
        'cruzador': 3,
        'porta-avioes': 1,
        'destroyer': 1,
        'submarino': 1,
        'couracado': 1
    },
    'Austrália': {
        'couracado': 1,
        'cruzador': 3,
        'submarino': 1,
        'porta-avioes': 1,
        'torpedeiro': 1
    },
    'Rússia': {
        'cruzador': 1,
        'porta-avioes': 1,
        'couracado': 2,
        'destroyer': 1,
        'submarino': 1
    },
    'Japão': {
        'torpedeiro': 2,
        'cruzador': 1,
        'destroyer': 2,
        'couracado': 1,
        'submarino': 1
    }
}


ALFABETO = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'
def cria_mapa(tamanho):
    return [[' ' for _ in range(tamanho)] for _ in range(tamanho)]

def posicao_suporta(mapa, tamanho_navio, linha, coluna, orientacao):
    n = len(mapa)
    if orientacao == 'v':
        if linha + tamanho_navio > n:
            return False
        for i in range(tamanho_navio):
            if mapa[linha + i][coluna] != ' ':
                return False
    elif orientacao == 'h':
        if coluna + tamanho_navio > n:
            return False
        for i in range(tamanho_navio):
            if mapa[linha][coluna + i] != ' ':
                return False
    return True

def escolhe_nacao():
    print("Escolha uma nação:")
    for pais in PAISES.keys():
        print(pais)
    pais_escolhido = input("Digite o nome da nação: ")
    return PAISES[pais_escolhido]

def gera_tamanhos_navios(nacao):
    tamanhos_navios = []
    for tipo_navio, quantidade in nacao.items():
        for _ in range(quantidade):
            tamanhos_navios.append(CONFIGURACAO[tipo_navio])
    return tamanhos_navios

def aloca_navios(mapa, tamanhos_navios):
    for tamanho in tamanhos_navios:
        while True:
            linha = random.randint(0, len(mapa) - 1)
            coluna = random.randint(0, len(mapa) - 1)
            orientacao = random.choice(['h', 'v'])
            if posicao_suporta(mapa, tamanho, linha, coluna, orientacao):
                for i in range(tamanho):
                    if orientacao == 'v':
                        mapa[linha + i][coluna] = 'N'
                    else:
                        for i in range(tamanho):
                            mapa[linha][coluna + i] = 'N'
                break

def foi_derrotado(mapa):
    for linha in mapa:
        if 'N' in linha:
            return False
    return True

def print_mapa(mapa):
    colunas = ALFABETO[:len(mapa)]
    print("  " + " ".join(colunas))
    linha_numero = 1
    for linha in mapa:
        print(str(linha_numero).rjust(2) + " " + " ".join(linha))
        linha_numero += 1

def aloca_navios_humano(mapa, tamanhos_navios):
    print("Por favor, aloque seus navios no mapa:")
    print_mapa(mapa)
    for tamanho in tamanhos_navios:
        while True:
            print("Navio de tamanho " + str(tamanho) + ":")
            linha = int(input("Linha (1 a " + str(len(mapa)) + "): ")) - 1
            coluna = input("Coluna (A a J): ").upper()
            coluna = ALFABETO.find(coluna)
            orientacao = input("Orientação (vertical 'v' ou horizontal 'h'): ")
            if posicao_suporta(mapa, tamanho, linha, coluna, orientacao):
                for i in range(tamanho):
                    if orientacao == 'v':
                        mapa[linha + i][coluna] = 'N'
                    else:
                        for i in range(tamanho):
                            mapa[linha][coluna + i] = 'N'
                print_mapa(mapa)
                break
            else:
                print("Posição inválida ou ocupada, tente novamente.")

def jogo_batalha_naval():
    tamanho_mapa = 10
    nacao = escolhe_nacao()
    tamanhos_navios = gera_tamanhos_navios(nacao)
    mapa_humano = cria_mapa(tamanho_mapa)
    mapa_computador = cria_mapa(tamanho_mapa)
    mapa_computador_oculto = cria_mapa(tamanho_mapa)

    aloca_navios_humano(mapa_humano, tamanhos_navios)
    aloca_navios(mapa_computador, tamanhos_navios)

    turno_humano = random.choice([True, False])
    while not (foi_derrotado(mapa_humano) or foi_derrotado(mapa_computador)):
        if turno_humano:
            print("Sua vez de atacar:")
            print_mapa(mapa_computador_oculto)
            linha = int(input("Escolha a linha (1 a 10): ")) - 1
            coluna = input("Escolha a coluna (A a J): ").upper()
            coluna = ALFABETO.find(coluna)
            if mapa_computador[linha][coluna] == 'N':
                print("Você acertou um navio!")
                mapa_computador_oculto[linha][coluna] = 'X'
            else:
                print("Água.")
                mapa_computador_oculto[linha][coluna] = 'A'
            turno_humano = False
        else:
            print("Vez do computador atacar.")
            linha = random.randint(0, tamanho_mapa - 1)
            coluna = random.randint(0, tamanho_mapa - 1)
            if mapa_humano[linha][coluna] == 'N':
                print("O computador acertou um dos seus navios!")
                mapa_humano[linha][coluna] = 'X'
            else:
                print("O computador atirou na água.")
            turno_humano = True

        if foi_derrotado(mapa_humano):
            print("Você perdeu!")
            break
        elif foi_derrotado(mapa_computador):
            print("Você venceu!")
            break

# Iniciar o jogo
jogo_batalha_naval()
